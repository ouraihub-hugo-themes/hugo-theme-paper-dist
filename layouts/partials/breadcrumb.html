{{- /*
Breadcrumb navigation component
Displays hierarchical navigation path for current page
Reference: astro-paper/src/components/Breadcrumb.astro
*/ -}}

{{- /* Only show breadcrumb on specific page types */ -}}
{{- if ne .Kind "home" -}}

{{- /* Get current URL path and remove trailing slash */ -}}
{{- $currentPath := strings.TrimSuffix "/" .RelPermalink -}}
{{- $pathParts := split $currentPath "/" | after 1 -}}

{{- /* Build breadcrumb list based on page type */ -}}
{{- $breadcrumbList := slice -}}

{{- if eq .Kind "section" -}}
{{- /* For section pages (Posts list), show: Home > Posts (Page N) */ -}}
{{- $sectionTitle := .Title -}}
{{- /* Only show page number for paginated sections (not archives or search) */ -}}
{{- if and .Paginator (ne .Section "archives") (ne .Section "search") -}}
{{- $sectionTitle = printf "%s (Page %d)" .Title .Paginator.PageNumber -}}
{{- end -}}
{{- $breadcrumbList = slice (dict "title" $sectionTitle "url" "" "current" true) -}}

{{- else if eq .Kind "page" -}}
{{- /* For regular pages (posts), show: Home > Title */ -}}
{{- $breadcrumbList = slice (dict "title" .Title "url" "" "current" true) -}}

{{- else if eq .Kind "term" -}}
{{- /* For taxonomy terms (tags/categories), show: Home > Tags > tag-name */ -}}
{{- $taxonomyName := .Data.Plural | humanize -}}
{{- $termName := .Title -}}

{{- $breadcrumbList = slice
(dict "title" $taxonomyName "url" (printf "/%s/" .Data.Plural) "current" false)
(dict "title" $termName "url" "" "current" true)
-}}

{{- else if eq .Kind "taxonomy" -}}
{{- /* For taxonomy list pages, show: Home > Tags */ -}}
{{- $taxonomyName := .Data.Plural | humanize -}}
{{- $breadcrumbList = slice (dict "title" $taxonomyName "url" "" "current" true) -}}

{{- end -}}

{{- /* Render breadcrumb navigation */ -}}
<nav class="mx-auto mt-8 mb-6 w-full max-w-app px-4" aria-label="breadcrumb">
  <ul class="text-sm font-light [&>li]:inline [&>li:not(:last-child)>a]:hover:opacity-100">
    {{- /* Home link */ -}}
    <li>
      <a href="/" class="opacity-70 hover:opacity-100 transition-opacity">Home</a>
      <span aria-hidden="true" class="mx-1">&raquo;</span>
    </li>

    {{- /* Render breadcrumb items */ -}}
    {{- range $index, $item := $breadcrumbList -}}
    {{- if $item.current -}}
    {{- /* Current page - no link */ -}}
    <li>
      <span class="capitalize opacity-70" aria-current="page">
        {{- $item.title -}}
      </span>
    </li>
    {{- else -}}
    {{- /* Intermediate link */ -}}
    <li>
      <a href="{{ $item.url }}" class="capitalize opacity-70 hover:opacity-100 transition-opacity">
        {{- $item.title -}}
      </a>
      <span aria-hidden="true" class="mx-1">&raquo;</span>
    </li>
    {{- end -}}
    {{- end -}}
  </ul>
</nav>

{{- end -}}
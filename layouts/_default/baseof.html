<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" dir="{{ .Site.Params.direction | default "ltr" }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="{{ .Description | default .Site.Params.description }}"
    />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <!-- Theme Color -->
    <meta name="theme-color" content="{{ .Site.Params.colors.primary }}" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{{ if .IsHome }}website{{ else }}article{{ end }}" />
    <meta property="og:url" content="{{ .Permalink }}" />
    <meta property="og:title" content="{{ .Title | default .Site.Title }}" />
    <meta
      property="og:description"
      content="{{ .Description | default .Site.Params.description }}"
    />
    {{- if .Params.image }}
      <meta property="og:image" content="{{ .Params.image | absURL }}" />
    {{- else if .Site.Params.seo.ogImage }}
      <meta property="og:image" content="{{ .Site.Params.seo.ogImage | absURL }}" />
    {{- end }}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ .Permalink }}" />
    <meta property="twitter:title" content="{{ .Title | default .Site.Title }}" />
    <meta
      property="twitter:description"
      content="{{ .Description | default .Site.Params.description }}"
    />
    {{- if .Site.Params.seo.twitterHandle }}
      <meta property="twitter:creator" content="{{ .Site.Params.seo.twitterHandle }}" />
    {{- end }}

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ .Permalink }}" />

    <!-- Alternate Links -->
    {{ range .AllTranslations }}
      <link
        rel="alternate"
        hreflang="{{ .Language.Lang }}"
        href="{{ .Permalink }}"
      />
    {{ end }}

    <!-- RSS Feed -->
    {{ if eq .Kind "home" }}
      <link
        rel="alternate"
        type="application/rss+xml"
        title="{{ .Site.Title }}"
        href="{{ .Site.Home.RelPermalink }}index.xml"
      />
    {{ end }}

    <!-- CSS -->
    <!-- Pre-built by Tailwind CLI, no PostCSS processing needed -->
    <link rel="stylesheet" href="/css/main.css" />

    <!-- Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Google Analytics (Optional) -->
    {{ if and .Site.Params.analytics.enable (eq .Site.Params.analytics.provider "google") }}
      {{ template "_internal/google_analytics.html" . }}
    {{ end }}

    <!-- SEO Meta Tags -->
    {{ partial "seo-meta.html" . }}

    <!-- JSON-LD Structured Data -->
    {{ partial "schema.html" . }}

    <!-- Title -->
    <title>{{ .Title | default .Site.Title }}{{ if not .IsHome }} - {{ .Site.Title }}{{ end }}</title>

    <!-- Custom Head -->
    {{ partial "head-custom.html" . }}
  </head>

  <body class="bg-background text-foreground transition-colors duration-300">
    <!-- Skip to main content link -->
    <a href="#main" class="sr-only focus:not-sr-only"> Skip to main content </a>

    <!-- Reading Progress Bar -->
    {{ partial "reading-progress.html" . }}

    <!-- Header -->
    {{ partial "header.html" . }}

    <!-- Main Content -->
    <main id="main" class="container-wrapper py-8 md:py-12">
      {{ block "main" . }}{{ end }}
    </main>

    <!-- Footer -->
    {{ partial "footer.html" . }}

    <!-- Back to top button -->
    {{ partial "back-to-top.html" . }}

    <!-- Inline SVG Icons -->
    {{ partial "icons.html" . }}

    <!-- Scripts -->
    {{ $ts := resources.Get "ts/main.ts" | js.Build (dict "minified" true) }}
    <script defer src="{{ $ts.RelPermalink }}"></script>

    <!-- Code Copy Functionality -->
    {{ partial "code-copy.html" . }}

    <!-- Keyboard Shortcuts -->
    {{ partial "keyboard-shortcuts.html" . }}

    <!-- Performance Optimization -->
    {{ partial "performance.html" . }}

    <!-- Custom Scripts -->
    {{ partial "scripts-custom.html" . }}
  </body>
</html>

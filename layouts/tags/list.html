{{ define "main" }}
<div class="max-w-4xl mx-auto">
  <!-- Page Header -->
  <div class="mb-12">
    <h1 class="text-4xl md:text-5xl font-bold mb-4">All Tags</h1>
    <p class="text-lg text-muted">
      Browse {{ len .Site.Taxonomies.tags }} tags
    </p>
  </div>

  <!-- Tags Cloud (Large) -->
  {{ $tags := .Site.Taxonomies.tags }}
  {{ if $tags }}
  <div class="mb-12 p-8 rounded-lg bg-gradient-bg border border-border">
    <h2 class="text-xl font-semibold mb-6">Tag Cloud</h2>
    <div class="flex flex-wrap gap-3 justify-center">
      {{ range $tags }}
      {{ $count := .Count }}
      {{ $size := "text-sm" }}
      {{ if ge $count 10 }}
        {{ $size = "text-xl" }}
      {{ else if ge $count 5 }}
        {{ $size = "text-lg" }}
      {{ end }}
      <a
        href="{{ .Page.RelPermalink }}"
        class="px-4 py-2 rounded-full transition-all duration-200 {{ $size }} font-medium
                 bg-secondary/10 text-secondary hover:bg-secondary hover:text-white hover:scale-110"
        title="{{ $count }} article{{ if ne $count 1 }}s{{ end }}"
      >
        #{{ .Page.Title }}
      </a>
      {{ end }}
    </div>
  </div>
  {{ end }}

  <!-- Tags List (Alphabetical) -->
  {{ if $tags }}
  <div class="mb-12">
    <h2 class="text-2xl font-bold mb-6">Tags by Name</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {{ range (sort $tags "Page.Title" "asc") }}
      <a
        href="{{ .Page.RelPermalink }}"
        class="group p-4 rounded-lg border border-border hover:border-primary hover:bg-primary/5 transition-all duration-200"
      >
        <div class="flex items-center justify-between">
          <h3 class="font-semibold group-hover:text-primary transition-colors">
            #{{ .Page.Title }}
          </h3>
          <span class="px-2 py-1 rounded text-xs bg-secondary/10 text-secondary">
            {{ len .Pages }}
          </span>
        </div>
      </a>
      {{ end }}
    </div>
  </div>
  {{ else }}
  <div class="py-12 text-center">
    <p class="text-muted text-lg">No tags found.</p>
  </div>
  {{ end }}

  <!-- Most Popular Tags -->
  {{ $popular := slice }}
  {{ range $tags }}
    {{ $popular = $popular | append . }}
  {{ end }}
  {{ range first 3 (sort $popular "Weight" "desc") }}
  <section class="mt-12 pt-12 border-t border-border">
    <h2 class="text-2xl font-bold mb-6">
      Popular: <span class="gradient-text">#{{ .Page.Title }}</span>
    </h2>
    <p class="text-muted mb-6">{{ len .Pages }} articles tagged with this</p>
    <div class="space-y-4">
      {{ range first 8 .Pages }}
      {{ partial "post-list-item.html" . }}
      {{ end }}
    </div>
    {{ if gt (len .Pages) 8 }}
    <a href="{{ .Page.RelPermalink }}" class="inline-block mt-6 text-primary hover:text-accent transition-colors">
      View all articles with #{{ .Page.Title }} â†’
    </a>
    {{ end }}
  </section>
  {{ end }}
</div>
{{ end }}
